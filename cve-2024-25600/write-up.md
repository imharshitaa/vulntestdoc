# WRITE UP:
---------------------------

Vulnerability Name (CVE ID):
-
CVE 2024 - 25600 

Vulnerability Short Description:
-
The Bricks WordPress theme has been reported as a vulnerability bug known as CVE-2024-25600. It is classified as a Remote Code Execution (RCE) vulnerability, which allows attackers to trick the server into running malicious code without authentication.

Description/Background: 
-
The Bricks Builder plugin for WordPress contains a severe vulnerability that permits unauthenticated remote code execution (RCE). This vulnerability, CVE-2024-25600, affects Bricks Builder versions <= 1.9.6. It poses a severe risk because it allows unauthenticated attackers to run arbitrary code remotely on the server that hosts the vulnerable WordPress site. Exploiting this vulnerability has the potential to compromise the entire site, steal data, and transmit malware to visitors. Bricks Builder is a popular WordPress developer theme, with around 25,000 active installations. It offers an easy drag-and-drop interface for designing and developing WordPress websites. This vulnerability takes use of a hole in the Bricks Builder plugin's processing of user input, allowing attackers to insert and run PHP code remotely. The Python code automates the exploitation process by obtaining nonces and submitting specially crafted requests to run arbitrary instructions.

CVSS V3 Severity and Metrics: 
-
Severity - Critical
Base Score - 10
Vector - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
Impact - Unauthenticated remote code execution

Exploitation:
- 
This python exploit script is designed to exploit the CVE-2024-25600 vulnerability found in the Bricks Builder plugin for WordPress. The vulnerability allows for unauthenticated remote code execution on affected websites. The tool automates the exploitation process by retrieving nonces and sending specially crafted requests to execute arbitrary commands.
The python script is a proof of concept exploit for the CVE 2024 25600. The script exploits the security token called nonces and conducts remote code execution.
It also automates the task of exploiting the vulnerability on the target URLs and files. The security token is found and the payload is created to exploit the vulnerability. After it is exploited, the user can execute arbitrary commands on the server from an interactive shell.

![12](https://github.com/imharshitaa/vulntestdoc/assets/143587481/8b68f071-513c-402e-99eb-a840fd9059c3)

This snippet of the python code involves creating the payload to exploit the vulnerability at the target. It includes functions with the nonce and command injection for the payload. And it's the function that is tested on the vulnerable endpoint to verify the exploit.
This task can be carried out on a docker container to run and deploy the exploit on a consistent and isolated environment. The steps involve:
Creating a dockerfile.
saving the following files in a directory: dockerfile, requirements.txt, exploit.py.
Using dockerfile build the docker image.
After building the image, the container is created and runs the exploit in the container.

![Untitled](https://github.com/imharshitaa/vulntestdoc/assets/143587481/f36c3140-81c3-45eb-97be-6df6461bce92)

After the exploit is run successfully, it shows that the target was exploitable with the CVE 2024 - 25600 vulnerability.

![photo_2024-06-11_16-21-15](https://github.com/imharshitaa/vulntestdoc/assets/143587481/a34930aa-eb80-4cc9-88ad-f55c0667a22b)

Potential Impact:
- 
The unauthenticated RCE vulnerability in Bricks Builder versions <= 1.9.6 enables attackers to execute arbitrary instructions on the target server. This can result in the entire compromise of the vulnerable WordPress site, allowing unauthorized access, data theft, and further server exploitation for malicious intent. Because the vulnerability can be abused by non-authenticated users, the attack surface is greatly expanded, exposing a vast number of websites to potential exploitation.
The exploit uses remote Code Execution to let attackers run arbitrary code on the server, allowing them to manipulate website content, steal sensitive data, and gain unwanted access to the hosting environment. Because of the Bricks Builder plugin's popularity among WordPress users for its design variety, a large number of websites are vulnerable until corrected.


Mitigation/Resolution:
-
Bricks Builder has issued a patch (version 1.9.6.1) to fix this vulnerability. To ensure the security of their sites, all Bricks Builder users must immediately update to this version. Delaying the update heightens the danger of exploitation.
If you are not actively using the Bricks REST API, disable it. This further decreases the assault surface.
Outdated software frequently contains security flaws, so it is necessary to regularly update all of your WordPress plugins and themes. 
Set up a powerful web application firewall (WAF), it can help to stop harmful requests before they reach your website.
Consider adding a security plugin, because these plugins can offer additional security against a variety of dangers.
Finally, implement regular web log monitoring to detect any strange behavior that could suggest exploitation attempts or successful breaches and conduct a thorough security check of your website to confirm that no illegal changes have occurred.

References:
-
https://github.com/Chocapikk/CVE-2024-25600/tree/main 

https://medium.com/@chinamayjoshi/unauthenticated-remote-code-execution-rce-vulnerability-in-bricks-builder-for-wordpress-a12132c91cc1 

https://op-c.net/blog/cve-2024-25600-wordpresss-bricks-builder-rce-flaw-under-active-exploitation/ 



-------------------------------------------
-------------------------------------------


Bricks Builder plugin for WordPress, which allows unauthenticated remote code execution 

The Bricks theme for WordPress has been identified as vulnerable to a critical security flaw known as CVE-2024-25600. 

It poses a significant risk as it allows unauthenticated attackers to execute arbitrary code remotely on the server hosting the vulnerable WordPress site.  

CVE-2024-25600 is classified under Remote Code Execution (RCE) vulnerabilities, enabling attackers to manipulate the server into executing malicious code without any authentication.

This vulnerability exploits a flaw in the Bricks Builder plugin's handling of user input, allowing attackers to inject and execute PHP code remotely. 

The exploitation of this vulnerability can lead to full site compromise, data theft, and potential spreading of malware to site visitors.

The python code automates the exploitation process by retrieving nonces and sending specially crafted requests to execute arbitrary commands.

critical vulnerability in the Bricks Builder plugin for WordPress, which allows unauthenticated remote code execution (RCE). This vulnerability, identified as CVE-2024â€“25600, affects Bricks Builder versions <= 1.9.6. 

Bricks Builder is a popular WordPress development theme with approximately 25,000 active installations. It provides an intuitive drag-and-drop interface for designing and building WordPress websites.

---------------------

impact

Unauthenticated Access: The exploit can be carried out without any authenticated session or user credentials, making every website running a vulnerable version of the Bricks Builder plugin an easy target.
Remote Code Execution: Successful exploitation allows attackers to execute arbitrary code on the server, providing the capability to modify website content, steal sensitive data, and gain unauthorized access to the hosting environment.
Widespread Risk: Given the popularity of the Bricks Builder plugin among WordPress users for its design flexibility, a significant number of websites are at risk until patched.

The unauthenticated RCE vulnerability in Bricks Builder versions <= 1.9.6 allows attackers to execute arbitrary commands on the target server. This can lead to complete compromise of the affected WordPress site, enabling unauthorized access, data theft, and further exploitation of the server for malicious purposes. As the vulnerability can be exploited by unauthenticated users, the attack surface is significantly wider, exposing a large number of websites to potential exploitation.

--------------------

mitigation

Update the Plugin: Upgrade the Bricks Builder plugin to the latest version immediately. The developers have released patches addressing this vulnerability in versions following 1.9.6.
Security Review: Conduct a thorough security review of your website to ensure no unauthorized modifications have been made.
Regular Monitoring: Implement regular monitoring of web logs for any suspicious activity that could indicate exploitation attempts or successful breaches.

Disable the Bricks REST API if not actively used. This further reduces the attack surface.
Regularly update all your WordPress plugins and themes. Outdated software often contains security vulnerabilities.
Implement a strong web application firewall (WAF). This can help block malicious requests before they reach your website.
Consider using a security plugin. These plugins can provide additional protection against various threats.


Bricks Builder has released a patch (version 1.9.6.1) to address this vulnerability. It is imperative that all users of Bricks Builder update to this version immediately to secure their sites. Delaying the update increases the risk of exploitation.

Updating Bricks Builder can typically be done directly within your WordPress dashboard. For detailed instructions, refer to the Bricks Builder website or their official documentation.


----------------

EXPLOITATION

This code is designed to exploit the CVE-2024-25600 vulnerability found in the Bricks Builder plugin for WordPress. The vulnerability allows for unauthenticated remote code execution on affected websites. The tool automates the exploitation process by retrieving nonces and sending specially crafted requests to execute arbitrary commands.

The python script is a proof of conept exploit for the CVE 2024 25600. The script exploits the security token called nonces and conducts remote code execution. 

It also automates the task of exploiting the vulnerability on the target URLs and files. The security token is found and the payload os created to exploit the vulnerability. After it is exploited, the user can execute arbitary commands on the server from an interactive shell. 

![image](https://github.com/imharshitaa/vulntestdoc/assets/143587481/45fead1f-b260-4cb5-a99d-ed870dfb384b)

This part of the python code involves creating the payload to exploit the vulnerability at the target. It includes functions with the nonce and command injection for the payload. And its the function that is tested on the vulnerable endpoint to verify the exploit. 

This task can be carried out on a docker container to run and deploy the exploit on a consistent and isolated environment. The steps involve: 
1. Creating a dockerfile.
2. saving the following files in a directory: dockerfile, requirements.txt, exploit.py.
3. Using dockerfile build the docker image.
4. After building the image, the container is created and run the exploit in the container. 

![Untitled](https://github.com/imharshitaa/vulntestdoc/assets/143587481/c32ad9fb-2046-4a35-a20c-33e284046d22)

After the exploit is run successfully, it shows that the target was exploitable with the CVE 2024 - 25600 vulnerability. 

![photo_2024-06-11_16-21-15](https://github.com/imharshitaa/vulntestdoc/assets/143587481/97527ea6-6d93-4a14-b7fb-02dfd050f0ff)



