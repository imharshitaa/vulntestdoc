# WRITE UP: CVE 2024 - 25600: Unauthenticated remote code execution
---------------------------


Vulnerability Name (CVE ID):
-
CVE 2024 - 25600 

Vulnerability Short Description:
-
The Bricks WordPress theme has been reported as a vulnerability bug known as CVE-2024-25600. It is classified as a Remote Code Execution (RCE) vulnerability, which allows attackers to trick the server into running malicious code without authentication.

Description/Background: 
-
The Bricks Builder plugin for WordPress contains a severe vulnerability that permits unauthenticated remote code execution (RCE). This vulnerability, CVE-2024-25600, affects Bricks Builder versions <= 1.9.6. It poses a severe risk because it allows unauthenticated attackers to run arbitrary code remotely on the server that hosts the vulnerable WordPress site. Exploiting this vulnerability has the potential to compromise the entire site, steal data, and transmit malware to visitors. Bricks Builder is a popular WordPress developer theme, with around 25,000 active installations. It offers an easy drag-and-drop interface for designing and developing WordPress websites. This vulnerability takes use of a hole in the Bricks Builder plugin's processing of user input, allowing attackers to insert and run PHP code remotely. The Python code automates the exploitation process by obtaining nonces and submitting specially crafted requests to run arbitrary instructions.



CVSS V3 Severity and Metrics: 
-

Affected systems/targets:

Bricks Builder versions <= 1.9.6


CVSS v3 Severity and Metrics:
- 

Base Score - 10

Impact score - 10

Exploitability score - 3.9

Attack vector (AV) - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

Attack complexity (AC) - Low

Privileges required (PR) - None

User Interaction (UI) - None

Scope (S) - Changed

Confidentiality (C)  - High

Integrity (I) - High

Availability (A) - High


Exploitation:
- 
This python exploit script is designed to exploit the CVE-2024-25600 vulnerability found in the Bricks Builder plugin for WordPress. The vulnerability allows for unauthenticated remote code execution on affected websites. The tool automates the exploitation process by retrieving nonces and sending specially crafted requests to execute arbitrary commands.
The python script is a proof of concept exploit for the CVE 2024 25600. The script exploits the security token called nonces and conducts remote code execution.
It also automates the task of exploiting the vulnerability on the target URLs and files. The security token is found and the payload is created to exploit the vulnerability. After it is exploited, the user can execute arbitrary commands on the server from an interactive shell.

![12](https://github.com/imharshitaa/vulntestdoc/assets/143587481/8b68f071-513c-402e-99eb-a840fd9059c3)

This snippet of the python code involves creating the payload to exploit the vulnerability at the target. It includes functions with the nonce and command injection for the payload. And it's the function that is tested on the vulnerable endpoint to verify the exploit.

The target website is identified which is running the vulnerable version of the wordpress plugin. When the HTTP GET request is sent by the attacker to the target URL, the nonce token is extracted from the script tag. 

![image](https://github.com/imharshitaa/vulntestdoc/assets/143587481/97331d3d-f01c-405e-8d9d-855588b6a649)

A malicious payload is created using the extracted nonce. The payload consists of the arbitrary PHP code that is designed to exploit the functions in the bricks builder plugin and run on the server. The attacker uses the payload to the target URL using HTTP POST request. 

![image](https://github.com/imharshitaa/vulntestdoc/assets/143587481/79907abc-448f-4129-906d-ea47d390b227)

![image](https://github.com/imharshitaa/vulntestdoc/assets/143587481/1a2e7ba6-e433-4ff2-9941-f69ded702d14)

When the target is vulnerable and exploitable, the server executes the payload and the exploit is verified by the serverâ€™s response. After the exploitation, an interactive shell can be opened, which allows the attacker to run additional commands on the server to gain unauthorized access. 



The CVE 2024 - 25600 is exploited by creating a dockerfile and building an image and executing the exploit inside a docker container. This method ensures simplified and isolated deployment of the exploitation. 


This task can be carried out on a docker container to run and deploy the exploit on a consistent and isolated environment. The steps involve:
Creating a dockerfile.
saving the following files in a directory: dockerfile, requirements.txt, exploit.py.
Using dockerfile build the docker image.
After building the image, the container is created and runs the exploit in the container.

![Untitled](https://github.com/imharshitaa/vulntestdoc/assets/143587481/f36c3140-81c3-45eb-97be-6df6461bce92)

After the exploit is run successfully, it shows that the target was exploitable with the CVE 2024 - 25600 vulnerability.

![photo_2024-06-11_16-21-15](https://github.com/imharshitaa/vulntestdoc/assets/143587481/a34930aa-eb80-4cc9-88ad-f55c0667a22b)



Potential Impact:
- 
The unauthenticated RCE vulnerability in Bricks Builder versions <= 1.9.6 enables attackers to execute arbitrary instructions on the target server. This can result in the entire compromise of the vulnerable WordPress site, allowing unauthorized access, data theft, and further server exploitation for malicious intent. Because the vulnerability can be abused by non-authenticated users, the attack surface is greatly expanded, exposing a vast number of websites to potential exploitation.
The exploit uses remote Code Execution to let attackers run arbitrary code on the server, allowing them to manipulate website content, steal sensitive data, and gain unwanted access to the hosting environment. Because of the Bricks Builder plugin's popularity among WordPress users for its design variety, a large number of websites are vulnerable until corrected.


Mitigation/Resolution:
-
Bricks Builder has issued a patch (version 1.9.6.1) to fix this vulnerability. To ensure the security of their sites, all Bricks Builder users must immediately update to this version. Delaying the update heightens the danger of exploitation.
If you are not actively using the Bricks REST API, disable it. This further decreases the assault surface.
Outdated software frequently contains security flaws, so it is necessary to regularly update all of your WordPress plugins and themes. 
Set up a powerful web application firewall (WAF), it can help to stop harmful requests before they reach your website.
Consider adding a security plugin, because these plugins can offer additional security against a variety of dangers.
Finally, implement regular web log monitoring to detect any strange behavior that could suggest exploitation attempts or successful breaches and conduct a thorough security check of your website to confirm that no illegal changes have occurred.

References:
-
https://github.com/Chocapikk/CVE-2024-25600/tree/main 

https://medium.com/@chinamayjoshi/unauthenticated-remote-code-execution-rce-vulnerability-in-bricks-builder-for-wordpress-a12132c91cc1 

https://op-c.net/blog/cve-2024-25600-wordpresss-bricks-builder-rce-flaw-under-active-exploitation/ 



-------------------------------------------
-------------------------------------------



